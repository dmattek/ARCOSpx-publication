<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Description of supplementary data</title>
  <link rel="stylesheet" href="sakura.css">
</head>
<body>

  <h1>Introduction</h1>
  <p>
    This document contains supplementary data for the publication: Gagliardi <i>et al.</i> (2022) <i>Automatic detection of spatio-temporal signalling patterns in cell collectives</i> <a href="https://doi.org/10.1101/2022.07.12.499734">(bioRxiv pre-print)</a>. The supplementary data contains:
    <li>CSV files with image segmentation results,</li>
    <li>R notebooks with results of the analysis,</li>
    <li>Jupyter notebooks to view the results in the napari image viewer.</li>
  </p>

  <p>Compiled by Maciej Dobrzyński, Cellular Dynamics Lab, Institute of Cell Biology, University of Bern, Switzerland.</p>

  <p>Due to storage restrictions source images are available upon request.</p>

  <h1>Code availability</h1>

  <p>
    Information about the algorithm and the implementations <a href="https://arcos.gitbook.io/home/">(GitBook link)</a>.
  </p>

  <p>ARCOS code is open-source and available to download:</p>

    <li>ARCOS R package written by Maciej Dobrzyński & Marc-Antoine Jacques <a href="https://github.com/pertzlab/ARCOS">(GitHub link)</a>.</li>
    <li>arcos4py, a Python implementation written by Benjamin Grädel <a href="https://github.com/pertzlab/arcos4py">(GitHub link)</a>.</li>
    <li>arcos-gui, a plugin with GUI for napari image viewer; written by Benjamin Grädel <a href="https://github.com/pertzlab/arcos-gui">(GitHub link)</a>; see a <a href="https://www.youtube.com/watch?v=hG_z_BFcAiQ">demo</a> on YouTube.</li>
  <p>

  </p>

  <h1>Datasets</h1>

  <p>All datasets and scripts to reproduce figures from the manuscript are deposited in the <a href="https://doi.org/10.17632/8gcncg6zkt">Mendeley Data repository</a>.</p>

  <p>Summary of experiments and their relationship to manuscript figures:</p>

  <table>
    <tr>
      <th>Experiment</th>
      <th>Acquired by</th>
      <th>Dataset</th>
      <th>Figure</th>
    </tr>
    <tr>
      <td align="left">Detection demo</td>
      <td>Maciej Dobrzyński</td>
      <td><a href="#synthdemo">Synthetic fireworks</a></td>
      <td>Code doc</td>
    </tr>
    <tr>
      <td align="left">De-trending and binarisation demo</td>
      <td>Paolo Gagliardi</td>
      <td><a href="#detrendbindemo">MCF10A WT 2019-10-25</a></td>
      <td>1D</td>
    </tr>
    <tr>
      <td rowspan="3" align="left">Synthetic ERK waves in MCF10A WT</td>
      <td rowspan="3" align="left">Paolo Gagliardi</td>
      <td><a href="#opto_concentricGrowth">Concentric Growth</a></td>
      <td>2C,D,E; S1D</td>
    </tr>
    <tr>
      <td><a href="#opto_circleTracking">Circle Tracking</a></td>
      <td>2F,G</td>
    </tr>
    <tr>
      <td><a href="#opto_splitTracking">Split Tracking</a></td>
      <td>2H,I</td>
    </tr>
    <tr>
      <td align="left">ERK waves in MCF10A mutants</td>
      <td>Paolo Gagliardi</td>
      <td><a href="#MCF10A_mutants">2021-09-15</a></td>
      <td>3; S2, S3</td>
    </tr>
    <tr>
      <td>Apoptosis-induced ERK waves in NRK-52E</td>
      <td align="left">Paolo Gagliardi</td>
      <td><a href="#NRK52E_ERK">2020-10-07_MDCK_and_NRK-52E_EKAR-FRET</a></td>
      <td>4A-C</td>
    </tr>
    <tr>
      <td align="left">Calcium waves in MDCK</td>
      <td><a href="https://www.sciencedirect.com/science/article/pii/S0960982219315945">Takeuchi et al.</a></td>
      <td><a href="#MDCK_calcium">FujitaFull_Fig1A</a></td>
      <td>4D-F</td>
    </tr>
    <tr>
      <td align="left">Bee shimmering waves</td>
      <td>Gerald Kastberger et al.</td>
      <td><a href="#BeeSchimmering">heq_i_r_u_o_cam{1|2}_mov0406</a></td>
      <td>4G,H</td>
    </tr>
    <tr>
      <td align="left">ERK waves in MCF10A-WT 3D acini</td>
      <td>Pascal Ender</td>
      <td><a href="#MCF10A_acini">2019-10-21_MCF10A-WT-3D_f01</a>
      <td>5</td>
    </tr>
    <tr>
      <td align="left">Detection from noisy images</td>
      <td>Benjamin Grädel</td>
      <td><a href="#degrad_image">Noisy images</a>
      <td>S4A-D</td>
    </tr>
    <tr>
      <td align="left">Detection from noisy time series</td>
      <td>Benjamin Grädel</td>
      <td><a href="#degrad_ts">Noisy time series</a>
      <td>S4E,F</td>
    </tr>
    <tr>
      <td align="left">NetLogo simulations</td>
      <td>Paolo Gagliardi</td>
      <td><a href="#NetLogo">NetLogo</a>
      <td>S1; S5</td>
    </tr>
  </table>

<h2 id="synthdemo">Detection demo</h2>

<p>
  Demonstration of detection of collective events in a synthetic 2D dataset: <a href="scripts/synth2Ddemo/synth2D.html">R notebook</a>.
</p>


<h2 id="detrendbindemo">De-trending and binarisation demo</h2>

<p>
  Demonstration of de-trending and binarisation of time series using a <code>runmed</code> method: <a href="scripts/TSdetrendDemo/detrendPlay.html">R notebook</a>.
</p>

<p>
  Demonstration of measurement binarisation using various local indicators of spatial association (LISA): <a href="scripts/optoCali/concentricGrowth/20200820_PatternStimulationOptoRAF_20X_concentricGrowth5min_ARCOS/cali-20200820-concentricGrowth-elsa-fov01_demoOnFrames.html">R notebook</a>.
</p>

<p>
  Using LISA statistics on a synthetic dataset to binarise <a href="scripts/NetLogoSims/frequent_rare/analysis-frequentsmall-lisa.html">frequent and small waves</a>, and <a href="scripts/NetLogoSims/frequent_rare/analysis-rarebig-lisa.html">rare and big waves</a>.
</p>


<h2 id="opto_concentricGrowth">Optogenetic calibration - concentric growth</h2>

<p>Dataset: 20200820_PatternStimulationOptoRAF_20X_concentricGrowth5min_ARCOS</p>

<p><b>Image acquisition parameters:</b>
  <li>Cell line: MCF10A WT opto-RAF, clone 1, with ERK-KTR biosensor</li>
  <li>Treatment: DMSO & optogenetic stimulation 10 x 100 ms, 1st pulse 10', other pulses every 5'</li>
  <li>FOV used in the analysis: 1</li>
  <li>Acquisition period: 1 minute</li>
  <li>Image scale: 1024 px = 662.5516 μm</li>
</p>

<p><b>Image processing parameters:</b>
  <li>Image segmentation: Ilastik, CP 3.18, μTrack</li>
  <li>Data input: <code>objNuclei_1line_clean_tracks_w01_fov01.csv.gz</code></li>
  <li>Data analysis: <code>cali-20200820-concentricGrowth-arcos-fov01.Rmd</code></li>
  <li>Activity clip: quantile (0.001, 1.)</li>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>runmed</code></li>
  <li>Short-term smoothing window: 5 frames</li>
  <li>Long-term smoothing window: 89 frames</li>
  <li>Peak threshold: 0.05</li>
  <li>Binarisation threshold: 0.25</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 65 px</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 3 cells</li>
  <li>Minimum duration of the collective event: 5 frames</li>
  <li>Minimum total number of cells involved in a collective event: 20 cells</li>
</p>


<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  └── input-data
      ├── experimentDescription.csv
      ├── frame
      │   ├── Position1_Ori_c0_t001.tif
      │   ├── Position2_Ori_c0_t001.tif
      │   └── Position3_Ori_c0_t001.tif
      ├── objNuclei_1line_clean_tracks_w0_fov01.csv.gz
      ├── stimStack.tif
      ├── stimulation
      │   ├── exp05_frame01.png
      │   ├── ...
      │   └── exp05_frame10.png
      └── Stimulation_timing.csv
</code>
</p>

<p>
  The <code>experimentDescription.csv</code> <a href="data/optoCali/concentricGrowth/20200820_PatternStimulationOptoRAF_20X_concentricGrowth5min_ARCOS/input-data/experimentDescription.csv">file</a>
  describes experimental conditions for every well/fov.
</p>

<p>
  The <code>frame</code> folder contains snapshots of the first frame of the time lapse.
</p>

<p>
  The <code>objNuclei_1line_clean_tracks_w0_fov01.csv.gz</code> contains fluorescent intensities of ERK-KTR from the nucleus and the cytosolic ring, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p>
  The <code>stimStack.tif</code> file and the <code>stimulation</code> folder contain the sequence of patterns for the optogenetic stimulation with the DMD device.
</p>

<p>
  The <code>Stimulation_timing.csv</code> <a href="data/optoCali/concentricGrowth/20200820_PatternStimulationOptoRAF_20X_concentricGrowth5min_ARCOS/input-data/Stimulation_timing.csv">file</a> contains timings of optogenetic stimulations.
</p>

<p><b>Results of the analysis:</b> <a href="scripts/optoCali/concentricGrowth/20200820_PatternStimulationOptoRAF_20X_concentricGrowth5min_ARCOS/cali-20200820-concentricGrowth-arcos-fov01.html">R notebook</a>.
</p>

<p><b>Results of randomisation tests:</b> <a href="scripts/optoCali/concentricGrowth/20200820_PatternStimulationOptoRAF_20X_concentricGrowth5min_ARCOS/cali-20200820-concentricGrowth-arcosBoot-fov01.html">R notebook</a>.
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/optoCali/concentricGrowth/20200820_PatternStimulationOptoRAF_20X_concentricGrowth5min_ARCOS/napariShow-runmed.ipynb">Jupyter notebook</a>.
</p>


<h2 id="opto_circleTracking">Optogenetic calibration - circle tracking</h2>

<p>Dataset: 20200818_PatternStimulationOptoRAF_20X_circleTracking_ARCOS</p>

<p><b>Image acquisition parameters:</b>
  <li>Cell line: MCF10A WT opto-RAF, clone 1, with ERK-KTR biosensor</li>
  <li>Treatment: DMSO & optogenetic stimulation 16 x 100 ms, every 10'</li>
  <li>FOV used in the analysis: 9</li>
  <li>Acquisition period: 1 minute</li>
  <li>Image scale: 1024 px = 662.5516 μm</li>
</p>

<p><b>Image processing parameters:</b>
  <li>Image segmentation: Ilastik, CP 3.18, μTrack</li>
  <li>Data input: <code>objNuclei_1line_clean_tracks_fov09.csv.gz</code></li>
  <li>Data analysis: <code>cali-20200818-circleTracking-arcos-fov09.Rmd</code></li>
  <li>Activity clip: quantile (0.002, 1.)</li>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>runmed</code></li>
  <li>Short-term smoothing window: 5 frames</li>
  <li>Long-term smoothing window: 49 frames</li>
  <li>Peak threshold: 0.1</li>
  <li>Binarisation threshold: 0.5</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 100 px</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 1 cell</li>
  <li>Minimum duration of the collective event: 5 frames</li>
  <li>Minimum total number of cells involved in a collective event: 3 cells</li>
</p>


<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  └── input-data
      ├── experimentDescription.csv
      ├── objNuclei_1line_clean_tracks_w0_fov09.csv.gz
      ├── stimStack.tif
      ├── stimulation
      │   ├── exp06_frame01.png
      │   ├── ...
      │   └── exp06_frame16.png
      └── Stimulation_timing.csv
</code>
</p>

<p>
  The <code>experimentDescription.csv</code> <a href="data/optoCali/circleTracking/20200818_PatternStimulationOptoRAF_20X_circleTracking_ARCOS/input-data/experimentDescription.csv">file</a>
  describes experimental conditions for every well/fov.
</p>

<p>
  The <code>frame</code> folder contains snapshots of the first frame of the time lapse.
</p>

<p>
  The <code>objNuclei_1line_clean_tracks_w0_fov01.csv.gz</code> contains fluorescent intensities of ERK-KTR from the nucleus and the cytosolic ring, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p>
  The <code>stimStack.tif</code> file and the <code>stimulation</code> folder contain the sequence of patterns for the optogenetic stimulation with the DMD device.
</p>

<p>
  The <code>Stimulation_timing.csv</code> <a href="data/optoCali/circleTracking/20200818_PatternStimulationOptoRAF_20X_circleTracking_ARCOS/input-data/Stimulation_timing.csv">file</a> contains timings of optogenetic stimulations.
</p>

<p><b>Results of the analysis:</b> <a href="scripts/optoCali/circleTracking/20200818_PatternStimulationOptoRAF_20X_circleTracking_ARCOS/cali-20200818-circleTracking-arcos-fov09.html">R notebook</a>.
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/optoCali/circleTracking/20200818_PatternStimulationOptoRAF_20X_circleTracking_ARCOS/napariShow-runmed.ipynb">Jupyter notebook</a>.
</p>


<h2 id="opto_splitTracking">Optogenetic calibration - split tracking</h2>

<p>Dataset: 20200818_PatternStimulationOptoRAF_20X_splitTracking_ARCOS</p>

<p><b>Image acquisition parameters:</b>
  <li>Cell line: MCF10A WT opto-RAF, clone 1, with ERK-KTR biosensor</li>
  <li>Treatment: DMSO & optogenetic stimulation 15 x 100 ms, every 10'</li>
  <li>FOV used in the analysis: 9</li>
  <li>Acquisition period: 1 minute</li>
  <li>Image scale: 1024 px = 662.5516 μm</li>
</p>

<p><b>Image processing parameters:</b>
  <li>Image segmentation: StarDist + btrack</li>
  <li>Data input: <code>tracked_btrack_filt_fov09.csv.gz</code></li>
  <li>Data analysis: <code>cali-20200818-splitTracking-luc-btrack-arcos-fov09.Rmd</code></li>
  <li>Activity clip: quantile (0.001, 0.999)</li>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>runmed</code></li>
  <li>Short-term smoothing window: 5 frames</li>
  <li>Long-term smoothing window: 89 frames</li>
  <li>Peak threshold: 0.05</li>
  <li>Binarisation threshold: 0.2</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 100 px</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 1 cell</li>
  <li>Minimum duration of the collective event: 5 frames</li>
  <li>Minimum total number of cells involved in a collective event: 3 cells</li>
</p>


<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  └── input-data
      ├── experimentDescription.csv
      ├── tracked_btrack_filt_fov09.csv.gz
      ├── stimStack.tif
      ├── stimulation
      │   ├── exp07_frame01.png
      │   ├── ...
      │   └── exp07_frame15.png
      └── Stimulation_timing.csv
</code>
</p>

<p>
  The <code>experimentDescription.csv</code> <a href="data/optoCali/splitTracking/20200818_PatternStimulationOptoRAF_20X_splitTracking_ARCOS/input-data/experimentDescription.csv">file</a>
  describes experimental conditions for every well/fov.
</p>

<p>
  The <code>frame</code> folder contains snapshots of the first frame of the time lapse.
</p>

<p>
  The <code>objNuclei_1line_clean_tracks_w0_fov01.csv.gz</code> contains fluorescent intensities of ERK-KTR from the nucleus and the cytosolic ring, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p>
  The <code>stimStack.tif</code> file and the <code>stimulation</code> folder contain the sequence of patterns for the optogenetic stimulation with the DMD device.
</p>

<p>
  The <code>Stimulation_timing.csv</code> <a href="data/optoCali/splitTracking/20200818_PatternStimulationOptoRAF_20X_splitTracking_ARCOS/input-data/Stimulation_timing.csv">file</a> contains timings of optogenetic stimulations.
</p>

<p><b>Results of the analysis:</b> <a href="scripts/optoCali/splitTracking/20200818_PatternStimulationOptoRAF_20X_splitTracking_ARCOS/cali-20200818-splitTracking-luc-btrack-arcos-fov09.html">R notebook</a>.
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/optoCali/splitTracking/20200818_PatternStimulationOptoRAF_20X_splitTracking_ARCOS/napariShow-runmed.ipynb">Jupyter notebook</a>.
</p>


<h2 id="MCF10A_mutants">ERK activity waves in MCF10A mutants</h2>

<h3>Dataset 1: 2019-02-24_Exp2_Tra-Shc-Pic</h3>

<p>
  <b>Image acquisition parameters:</b>
  <ul>
    <li>Cell line:</li>
    <ul>
      <li>MCF10A_WT_Clone1H, Well A1, FOVs 1,4,5,6</li>
      <li>MCF10A_KRAS-G12V_Clone3A, Well A3, FOV 1,3,4,5,6</li>
      <li>MCF10A_PIK3CA-H1047R_CloneG01, Well A5, FOV 1,2,3,4,5,6</li>
    </ul>
    <li>Biosensor: ERK-KTR</li>
    <li>Treatment: starved, DMSO 0.1%</li>
    <li>Acquisition period: 5 minutes</li>
    <li>Image scale: 1024 px = 332.80 μm</li>
  </ul>
</p>

<p>
  <b>Image processing parameters:</b>
  <ul>
    <li>Image segmentation: Ilastik, CP 3.18, μTrack</li>
    <li>Data input:</li>
    <ul>
      <li>WT: <code>objNuclei_1line_clean_tracks_wA1_fov0X.csv.gz</code></li>
      <li>KRAS: <code>objNuclei_1line_clean_tracks_wA3_fov0X.csv.gz</code></li>
      <li>PIK3CA: <code>objNuclei_1line_clean_tracks_wA5_fov0X.csv.gz</code></li>
    </ul>
    <li>Data analysis: <code>analysis-runmed.Rmd</code></li>
    <li>Activity clip: quantile (0.001, 0.999)</li>
  </ul>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>runmed</code></li>
  <li>Short-term smoothing window: 5 frames</li>
  <li>Long-term smoothing window: 49 frames</li>
  <li>Peak threshold: 0.05</li>
  <li>Binarisation threshold: 0.2</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 80px (WT, KRAS), 100 px (PIK3CA)</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 3 cells</li>
  <li>Minimum duration of the collective event: 2 frames</li>
  <li>Minimum total number of cells involved in a collective event: 3 cells</li>
</p>

<p>Note: frames 1-432 (0-36h) taken for analysis; FOV 1 (WT), 3 (KRAS), 1 (PIK3CA) for movies.</p>


<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  ├── WT
  │   ├── input-data
  │   │   ├── experimentDescription.csv
  │   │   └── objNuclei_1line_clean_tracks_wA1_fov0X.csv.gz
  │   └── TIFFs
  │       └── WellA1_Seq0000_SiteX_C3.tif
  ├── KRAS
  │   └── ...
  └── PIK3CA
      └── ...
</code>
</p>

<p>
  The <code>experimentDescription.csv</code> <a href="data/ERKwaves-MCF10A-mut_2019-02-24_Exp2/WT/input-data/experimentDescription.csv">file</a>
  describes experimental conditions for every well/fov.
</p>

<p>
  The <code>objNuclei_1line_clean_tracks_wA1_fov0X.csv.gz</code> contains fluorescent intensities of ERK-KTR from the nucleus and the cytosolic ring, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p><b>Results of the pooled analysis of all 3 cell lines:</b> <a href="scripts/ERKwaves-MCF10A-mut_2019-02-24_Exp2/3cellLinesPooled/mcf10a-3mutants-collective.html">R notebook</a>.
</p>

<p><b>Results of randomisation tests for WT, FOV 01:</b> <a href="scripts/ERKwaves-MCF10A-mut_2019-02-24_Exp2/WT/20190224-fov01-runmed-boot.html">R notebook</a>.<br>
  <b>Results of randomisation tests for KRAS, FOV 03:</b> <a href="scripts/ERKwaves-MCF10A-mut_2019-02-24_Exp2/KRAS/20190224-fov03-runmed-boot.html">R notebook</a>.<br>
  <b>Results of randomisation tests for PIK3CA, FOV 01:</b> <a href="scripts/ERKwaves-MCF10A-mut_2019-02-24_Exp2/PIK3CA/20190224-fov01-runmed-boot.html">R notebook</a>.
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/ERKwaves-MCF10A-mut_2019-02-24_Exp2/napariShow-runmed.ipynb">Jupyter notebook</a>.
</p>


<h3>Dataset 2: 2021-09-15</h3>

<p>
  <b>Image acquisition parameters:</b>
  <ul>
    <li>Cell line:</li>
    <ul>
      <li>MCF10A_WT_CloneF21, FOVs 1-3 (DMSO), 31-33 (Batimastat)</li>
      <li>MCF10A_KRAS-G12V_CloneF06, FOVs 13-15 (DMSO), 43-45 (Batimastat)</li>
      <li>MCF10A_PIK3CA-H1047R_CloneF23, FOVs 4-6 (DMSO), 34-36 (Batimastat)</li>
    </ul>
    <li>Biosensor: ERK-KTR</li>
    <li>Treatment: starved, DMSO 0.1%, 10uM Batimastat</li>
    <li>Acquisition period: 5 minutes</li>
    <li>Image scale: 1024 px = 664.66 μm</li>
  </ul>
</p>

<p>
  <b>Image processing parameters:</b>
  <ul>
    <li>Image segmentation: StarDist, CellPose, btrack</li>
    <li>Data input:<code>objNuclei_1line_clean_tracks_fov0X.csv.gz</code></li>
    <li>Data analysis: <code>analysis-runmed.Rmd</code></li>
    <li>Activity clip: quantile (0.0001, 0.9999)</li>
  </ul>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>runmed</code></li>
  <li>Short-term smoothing window: 5 frames</li>
  <li>Long-term smoothing window: 101 frames</li>
  <li>Peak threshold: 0.12</li>
  <li>Binarisation threshold: 0.2</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 45px</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 3 cells</li>
  <li>Minimum duration of the collective event: 3 frames</li>
  <li>Minimum total number of cells involved in a collective event: 3 cells</li>
</p>

<p>Note: frames 1-288 (0-24h) taken for analysis; DMSO: FOV 3 (WT), 14 (KRAS), 6 (PIK3CA); Batimastat: 31 (WT), 45 (KRAS), 36 (PIK3CA) for movies.</p>


<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  ├── WT_DMSO
  │   ├── input-data
  │   │   ├── experimentDescription.csv
  │   │   └── objNuclei_1line_clean_tracks_fov0X.csv.gz
  │   └── TIFFs
  │       └── C3-XX_Ori.tif
  ├── KRAS_DMSO
  │   └── ...
  │ ...
</code>
</p>

<p>
  The <code>experimentDescription.csv</code> <a href="data/ERKwaves-MCF10A-mut_2021-09-15_starDist/WT/input-data/experimentDescription.csv">file</a>
  describes experimental conditions for every well/fov.
</p>

<p>
  The <code>objNuclei_1line_clean_tracks_wA1_fov0X.csv.gz</code> contains fluorescent intensities of ERK-KTR from the nucleus and the cytosolic ring, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p><b>Results of the pooled analysis of all 3 cell lines:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/3cellLinesPooled/mcf10a-3mutants-collective.html">R notebook</a>.
</p>

<p>
  <b>Results of randomisation tests for WT+DMSO, FOV 03:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/WT_DMSO/20210915-fov03-runmed-boot.html">R notebook</a>.<br>
  <b>Results of randomisation tests for KRAS+DMSO, FOV 14:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/KRAS_DMSO/20210915-fov14-runmed-boot.html">R notebook</a>.<br>
  <b>Results of randomisation tests for PIK3CA+DMSO, FOV 06:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/PIK3CA_DMSO/20210915-fov06-runmed-boot.html">R notebook</a>.<br>
  <b>Results of randomisation tests for WT+Batimastat, FOV 31:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/WT_Bati/20210915-fov31-runmed-boot.html">R notebook</a>.<br>
  <b>Results of randomisation tests for KRAS+Batimastat, FOV 45:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/KRAS_Bati/20210915-fov45-runmed-boot.html">R notebook</a>.<br>
  <b>Results of randomisation tests for PIK3CA+Batimastat, FOV 36:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/PIK3CA_Bati/20210915-fov36-runmed-boot.html">R notebook</a>.
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/ERKwaves-MCF10A-mut_2021-09-15_starDist/napariShow-runmed.ipynb">Jupyter notebook</a>.
</p>



<h2 id="NRK52E_ERK">ERK activity waves in NRK-52E</h2>

<p>Dataset: 2020-10-07_MDCK_and_NRK-52E_EKAR-FRET-Aoki_Dox_20x_T5min_REVISION-APO</p>

<p><b>Image acquisition parameters:</b>
  <li>Cell line: NRK-52E EKAR</li>
  <li>Treatment: starved, 1μM Doxorubicin</li>
  <li>FOV used in the analysis: 31,32,34,35,36,37,39,40,41,45,56</li>
  <li>Acquisition period: 5 minutes</li>
  <li>Image scale: 1024 px = 664.6601 μm</li>
</p>

<p><b>Image processing parameters:</b>
  <li>Image segmentation: Ilastik, CP 3.18 (with illumination correction), μTrack</li>
  <li>Data input: <code>objNuclei_1line_clean_tracks_fov34.csv.gz</code></li>
  <li>Data analysis: <code>20201007-nrk-ekar-elsa-fov34.Rmd</code></li>
  <li>Activity clip: quantile (0.001, 0.999)</li>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>ELSA - local G*</code></li>
  <li>Min & max radii: 10, 100 px</li>
  <li>Binarisation threshold: e>6</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 90 px</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 1 cell</li>
  <li>Minimum duration of the collective event: 2 frames</li>
  <li>Minimum total number of cells involved in a collective event: 5 cells</li>
</p>

<p>
  Note: taking lower left quart of the FOV due to uneven illumination; even though corrected, the dynamic range in other areas is low. FOV 34 for the movie.
</p>

<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  └── input-data
      ├── apoManualXYT.csv
      ├── experimentDescription.csv
      └── objNuclei_1line_clean_tracks_fovXX.csv.gz
</code>
</p>

<p>
  The <code>apoManualXYT.csv</code> <a href="data/ERKwaves-NRK52E/input-data/apoManualXYT.csv">file</a>
  contains manual annotations of apoptosis for every well/fov.
</p>

<p>
  The <code>experimentDescription.csv</code> <a href="data/ERKwaves-NRK52E/input-data/experimentDescription.csv">file</a>
  describes experimental conditions for every well/fov.
</p>

<p>
  The <code>objNuclei_1line_clean_tracks_fovXX.csv.gz</code> contains FRET ratio of EKAR probe, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p><b>Results of the pooled analysis of all FOVs:</b> <a href="scripts/ERKwaves-NRK52E/20201007-nrk-ekar-elsa-pooled.html">R notebook</a>.
</p>

<p><b>Results of randomisation tests for FOV 34:</b> <a href="scripts/ERKwaves-NRK52E/20201007-nrk-ekar-elsa-boot-fov34.html">R notebook</a>.<br>
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/ERKwaves-NRK52E/napariShow-elsa.ipynb">Jupyter notebook</a>.
</p>


<h2 id="MDCK_calcium">Calcium waves in MDCK</h2>

<p>Data courtesy of <a href="https://www.med.kyoto-u.ac.jp/en/organization-staff/research/doctoral_course/r-014/">prof. Yasuyuki Fujita</a>. The system described earlier in <a href="https://www.sciencedirect.com/science/article/pii/S0960982219315945">Takeuchi et al. (2020) Calcium Wave Promotes Cell Extrusion, Curr Biol 30(4)</a>.</p>

<p>Dataset: FujitaFull_Fig1A</p>

<p><b>Image acquisition parameters:</b>
  <li>Cell line: MDCK-GCaMP6S</li>
  <li>Treatment: growth medium</li>
  <li>FOV used in the analysis: 1</li>
  <li>Acquisition period: 5 seconds</li>
  <li>Image scale: 1024 px = 880.6405 μm</li>
</p>

<p><b>Image processing parameters:</b>
  <li>Image segmentation: custom Python code</li>
  <li>Data input: <code>Fig1A-sig6.csv.gz</code></li>
  <li>Data analysis: <code>FujitaFull_Fig1A.Rmd</code></li>
  <li>Activity clip: quantile (0.001, 0.990)</li>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>ELSA - local G*</code></li>
  <li>Min & max radii: 10, 100 px</li>
  <li>Binarisation threshold: e>16</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 100 px</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 3 cells</li>
  <li>Minimum duration of the collective event: 2 frames</li>
  <li>Minimum total number of cells involved in a collective event: 5 cells</li>
</p>

<p>
  Note: taking frames 2300-2460 for the movie.
</p>

<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  └── input-data
      ├── Fig.1A-full-apo.csv
      └── Fig1A-sig6.csv.gz
</code>
</p>

<p>
  The <code>Fig.1A-full-apo.csv</code> <a href="data/calciumWaves-MDCK/input-data-full/Fig.1A-full-apo.csv">file</a>
  contains manual annotations of apoptosis for every well/fov.
</p>

<p>
  The <code>Fig1A-sig6.csv.gz</code> contains the cyto/nuclear ratio of the calcium probe, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p><b>Results of the analysis:</b> <a href="scripts/calciumWaves-MDCK/calciumWaves_subF2300-2460.html">R notebook</a>.
</p>

<p><b>Results of randomisation tests for frames 2300-2460:</b> <a href="scripts/calciumWaves-MDCK/calciumWaves_subF2300-2460-boot.html">R notebook</a>.<br>
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/calciumWaves-MDCK/napariShow-elsa.ipynb">Jupyter notebook</a>.
</p>


<h2 id="BeeSchimmering">Bee shimmering</h2>

<p>Data contributed by <a href="http://www.gerald-kastberger.at">prof. Gerald Kastberger</a>.</p>

<p>Dataset: heq_i_r_u_o_cam{1|2}_mov0406_frame00{002-900}</p>

<p><b>Image acquisition parameters:</b>
  <li>Treatment: a dummy wasp</li>
  <li>Acquisition period: 1/60 s</li>
  <li>Image scale: 1 px = 0.3 mm</li>
</p>

<p><b>Image processing parameters:</b>
  <li>Image segmentation: Ilastik, CP 3.18, overlap tracking 2px</li>
  <li>Data input: <code>objAbdomen_essential.csv.gz</code></li>
  <li>Data analysis: <code>bees_full.Rmd</code></li>
  <li>Activity clip: quantile (0.03, 0.99)</li>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>ELSA - local G*</code></li>
  <li>Min & max radii: 10, 100 px</li>
  <li>Binarisation threshold: e>5.5</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 150 px</li>
  <li>Linking of consecutive frames: 1 frame</li>
  <li>Minimum cluster size for dbscan: 3 bees</li>
  <li>Minimum duration of the collective event: 5 frames</li>
  <li>Minimum total number of cells involved in a collective event: 5 bees</li>
</p>

<p>
  Note: taking frames 260-340 for the movie.
</p>

<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  └── input-data
      └── objAbdomen_essential.csv.gz
</code>
</p>

<p>
  The <code>objAbdomen_essential.csv.gz</code> intensities of bee shimmering, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p><b>Results of the analysis:</b> <a href="scripts/beeShimmering/bees_full.html">R notebook</a>.
</p>

<p><b>Results of randomisation tests:</b> <a href="scripts/beeShimmering/bees_full-boot.html">R notebook</a>.<br>
</p>

<p><b>Visualisation in napari image viewer:</b> <a href="scripts/beeShimmering/napariShow-elsa.ipynb">Jupyter notebook</a>.
</p>


<h2 id="MCF10A_acini">MCF10A WT 3D acini</h2>

<p>Dataset: 2019-10-21_MCF10A-WT-3D_f01</p>

<p><b>Image acquisition parameters:</b>
  <li>Cell line: MCF10A WT with ERK-KTR biosensor</li>
  <li>Treatment: starved, DMSO 0.1%</li>
  <li>FOV used in the analysis: 1</li>
  <li>Acquisition period: 3  minutes</li>
  <li>Image scale: 1 px (x,y,z) = (0.37, 0.37, 0.60) μm</li>
</p>

<p><b>Image processing parameters:</b>
  <li>Image segmentation: LEVER.js (Andy Cohen)</li>
  <li>Data input: <code>tracks_191021_wt_curated.csv.csv.gz</code></li>
  <li>Data analysis: <code>20191021-fov01-runmed.Rmd</code></li>
  <li>Activity clip: quantile (0.001, 0.999)</li>
</p>


<p><b>Activity detection:</b>
  <li>The algorithm: <code>runmed</code></li>
  <li>Short-term smoothing window: 3 frames</li>
  <li>Long-term smoothing window: 41 frames</li>
  <li>Peak threshold: 0.1</li>
  <li>Binarisation threshold: 0.25</li>
</p>

<p><b>Cluster detection:</b>
  <li>Search radius for dbscan and linking clusters between frames: 0.45 μm</li>
  <li>Linking of consecutive frames: 2 frames</li>
  <li>Minimum cluster size for dbscan: 1 cell</li>
  <li>Minimum duration of the collective event: 2 frames</li>
  <li>Minimum total number of cells involved in a collective event: 2 cells</li>
</p>

<p><b>Directory structure:</b>
<code style="display:block; white-space:pre-wrap">
  └── input-data
      └── tracks_191021_wt_curated.csv
</code>
</p>

<p>
  The <code>tracks_191021_wt_curated.csv</code> contains the cyto/nuclear ratio of the ERK-KTR probe, as well as track ID associations. The dataset is in <b>long format</b>.
</p>

<p><b>Results of the analysis:</b> <a href="scripts/ERKwaves-MCF10A-3D/acini/20191021-fov01-runmed.html">R notebook</a> with interactive elements to browse the data.
</p>


<h2 id="degrad_image">Image degradation</h2>

<p>
  Detection of collective events from noisy images: <a href="scripts/Segmentation_Degradation/segmentation_degradation_arcos_SNR-db.ipynb">Jypyter notebook</a>.
</p>

<h2 id="degrad_ts">Time series degradation</h2>

<p>
  Detection of collective events from noisy time series: <a href="scripts/Timeseries_Degradation/timeseries_degradation_arcos.ipynb">Jypyter notebook</a>.
</p>

<h2 id="NetLogo">NetLogo simulations of epithelial waves</h2>

<p>
  Demonstration of randomisation methods: <a href="scripts/NetLogoSims/DoseResponseCurve_Restricted/Gradient20-boot.html">R notebook</a>.
</p>

<p>
  Detection of collective events as a function of search radius eps: <a href="scripts/NetLogoSims/DoseResponseCurve_Restricted/analysis-Gradient20.html">R notebook</a>.
</p>

<p>
  Detection of collective events as a function of total activity: <a href="scripts/NetLogoSims/DoseResponseCurve_Restricted/analysis-all.html">R notebook</a>.
</p>


</body>
</html>
